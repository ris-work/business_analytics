SELECT PLU_CODE, PLU_DESC, SIH FROM VIEW_ITEMWISESTOCKBALANCE;
--SELECT a.DET_PROCODE as itemcode, a.RUNNO, convert(varchar(33), a.RUNDATE, 127) as date, b.DET_CPRICE as cost FROM (SELECT DISTINCT max(HED_RUNNO) AS RUNNO, max(HED_DATE) as RUNDATE, DET_PROCODE FROM VIEW_PURCHASEDTLS GROUP BY DET_PROCODE HAVING datalength(max(HED_RUNNO)) > 0) a JOIN VIEW_PURCHASEDTLS b ON ((b.HED_RUNNO = a.RUNNO) OR ((b.HED_RUNNO IS NULL) AND (a.RUNNO IS NULL))) AND a.DET_PROCODE = b.DET_PROCODE;
-- SELECT DISTINCT DET_PROCODE FROM VIEW_PURCHASEDTLS;
-- SELECT TOP(10) * FROM VIEW_PURCHASEDTLS ORDER BY HEAD_RUNNO;
-- SELECT T_TBLINVDETAILS.INVDET_PROCODE as productcode, LEFT(convert(varchar, T_TBLINVHEADER.INVHED_TXNDATE, 126), 10) as daydate, AVG(T_TBLINVDETAILS.INVDET_PROCOST) as cost FROM T_TBLINVHEADER INNER JOIN T_TBLINVDETAILS ON T_TBLINVHEADER.INVHED_SETUPLOC = T_TBLINVDETAILS.INVDET_SETUPLOC AND T_TBLINVHEADER.INVHED_LOCCODE = T_TBLINVDETAILS.INVDET_LOCCODE AND T_TBLINVHEADER.INVHED_INVNO = T_TBLINVDETAILS.INVDET_INVNO AND T_TBLINVHEADER.INVHED_MODE = T_TBLINVDETAILS.INVDET_MODE WHERE (T_TBLINVHEADER.INVHED_CANCELED = 0) AND (T_TBLINVHEADER.INVHED_INVOICED = 1) AND (T_TBLINVHEADER.INVHED_LOCCODE IN ('001')) AND (T_TBLINVDETAILS.INVDET_VOID = 0)  AND (T_TBLINVHEADER.INVHED_MODE = 'INV') GROUP BY T_TBLINVDETAILS.INVDET_PROCODE, LEFT(convert(varchar, T_TBLINVHEADER.INVHED_TXNDATE, 126), 10) ORDER BY productcode, daydate
