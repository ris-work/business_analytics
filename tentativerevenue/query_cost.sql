SELECT T_TBLINVDETAILS.INVDET_PROCODE as productcode, LEFT(convert(varchar, T_TBLINVDETAILS.INVDET_TXNDATE, 126), 10) as daydate, RIGHT(LEFT(convert(varchar, T_TBLINVDETAILS.INVDET_TIME, 126), 13), 2) as timehour,  SUM(T_TBLINVDETAILS.INVDET_UNITQTY) as qty, SUM(INVDET_AMOUNT) AS sumsell, SUM(INVDET_PROCOST * INVDET_UNITQTY) AS sumcost FROM T_TBLINVDETAILS WHERE (T_TBLINVDETAILS.INVDET_VOID = 0) AND (T_TBLINVDETAILS.INVDET_MODE = 'INV') GROUP BY T_TBLINVDETAILS.INVDET_PROCODE, LEFT(convert(varchar, T_TBLINVDETAILS.INVDET_TXNDATE, 126), 10), RIGHT(LEFT(convert(varchar, T_TBLINVDETAILS.INVDET_TIME, 126), 13), 2) ORDER BY productcode, daydate, timehour
